<html>
  <head>
    <meta http-equiv="pragma" content="no-cache" />

    <script src="ConnectWiseHostedAPI.1.0.js"></script>
    <script src="util.js"></script>
    <link href="style.css" rel="stylesheet" />

    <script language="javascript">
      var connectWiseClientApi;
      var dirty = false;

      document.addEventListener("DOMContentLoaded", function (event) {
        onReady();
      });

      function onReady() {
        connectWiseClientApi = new ConnectWiseHostedAPI(
          "https://na.myconnectwise.net",
          {
            eventHandlers: [
              { event: "onLoad", callback: onLoadCallback },
              { event: "beforeSave", callback: beforeSaveCallback },
            ],
          },
          true
        );

        var required = document.getElementById("required");
        var number = document.getElementById("number");

        required.oninput = setDirty;
        number.oninput = setDirty;

        document.getElementById("btnMemberAuthentication").onclick =
          function () {
            connectWiseClientApi.post(
              { request: "getMemberAuthentication" },
              function (data) {
                document.getElementById("lblMemberAuthentication").innerText =
                  data.site +
                  " " +
                  data.companyid +
                  " " +
                  data.memberid +
                  " " +
                  data.memberHash +
                  " " +
                  data.memberEmail;
              }
            );
          };

        document.getElementById("btnRefreshScreen").onclick = function () {
          connectWiseClientApi.post({ request: "refreshScreen" });
        };

        document.getElementById("btnOpen").onclick = function () {
          openScreen();
        };
      }

      function openScreen() {
        var newTab =
          document.getElementById("lstTab").options[
            document.getElementById("lstTab").selectedIndex
          ].innerHTML === "new";
        var screenID =
          document.getElementById("lstScreen").options[
            document.getElementById("lstScreen").selectedIndex
          ].innerHTML;
        var id = document.getElementById("txtOpenID").value;

        connectWiseClientApi.post({
          request: "openScreen",
          args: { newTab: newTab, screen: screenID, id: id },
        });
      }

      function onLoadCallback(data) {
        showMsg(
          data.screenObject.screen +
            " loaded! Hosted as: " +
            data.screenObject.hostedAs
        );
        setField("recid", data.screenObject.id);
      }

      function setField(fieldID, value) {
        var field = document.getElementById(fieldID);
        field.value = value;
      }

      function beforeSaveCallback(data) {
        var required = document.getElementById("required");
        var number = document.getElementById("number");

        var errors = [];

        if (required.value == null || required.value == "") {
          required.className = "error";
          errors.push("Example required field is empty!");
        } else {
          required.className = "";
        }

        if (number.value != null && number.value != "" && isNaN(number.value)) {
          number.className = "error";
          errors.push("Example number field must be a number!");
        } else {
          number.className = "";
        }

        if (errors.length > 0) {
          data.onFailure(errors);
        } else {
          dirty = false;
          data.onSuccess();
        }
      }

      function setDirty() {
        if (dirty) {
          return;
        }

        dirty = true;
        connectWiseClientApi.post({
          request: "setDirty",
          args: { dirty: dirty },
        });
      }

      function showMsg(msg) {
        var lbl = document.getElementById("msg");
        lbl.innerText = msg;
      }
    </script>

    <style>
      .error {
        border: 1px solid #ff0000;
        background-color: #ffeeee;
      }
      div {
        padding: 1px;
      }

      .form-class {
        display: inline-block;
      }
    </style>
  </head>
  <body>
    <form action="" method="post"></form>
		<div class="form-class">
			<label for="Product">Choose Product</label>
			<select name="product" id="cars">
			  <option value="Automate">Automate</option>
			  <option value="Manage">Manage</option>
			  <option value="Control">Control</option>
			</select>
		  </div>
	  
		  <div class="form-class">
			<label for="ChooseTask">Choose Automation Task</label>
			<select name="Automation Task" id="task">
			  <option value="task1">task1</option>
			  <option value="task2">task2</option>
			  <option value="task3">task3</option>
			  <option value="task4">task4</option>
			</select>
		  </div>

		  <div>
			  
		  </div>

		  <div>
			  <!-- <h4>Description:</h4> -->
			  <p> <b>Description:</b> this is the description of the task that is taken from json input using javascript. this is the description of the task that is taken from json input using javascript. this is the description of the task that is taken from json input using javascript. this is the description of the task that is taken from json input using javascript. this is the description of the task that is taken from json input using javascript. this is the description of the task that is taken from json input using javascript. this is the description of the task that is taken from json input using javascript. this is the description of the task that is taken from json input using javascript. this is the description of the task that is taken from json input using javascript. this is the description of the task that is taken from json input using javascript. this is the description of the task that is taken from json input using javascript. this is the description of the task that is taken from json input using javascript. this is the description of the task that is taken from json input using javascript. this is the description of the task that is taken from json input using javascript. this is the description of the task that is taken from json input using javascript.</p>
		  </div>



	



  </body>
</html>
